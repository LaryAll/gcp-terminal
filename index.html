<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GCP Terminal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background-color: #000000;
      color: #33ff33;
      font-family: 'Courier New', Courier, monospace;
      font-size: clamp(12px, 2.5vw, 16px);
      line-height: 1.6;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .wrapper {
      overflow-y: auto;
      padding: 16px;
      flex-grow: 1;
    }

    .terminal {
      max-width: 1000px;
      width: 100%;
      margin: 0 auto;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .block-scroll {
      overflow-x: auto;
      white-space: pre;
    }

    .cursor {
      display: inline-block;
      font-weight: bold;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      50% {
        opacity: 0;
      }
    }

    #audio-btn {
      background: none;
      color: #33ff33;
      font-family: 'Courier New', Courier, monospace;
      border: 1px solid #33ff33;
      padding: 10px;
      cursor: pointer;
      font-size: 16px;
      width: 100%;
    }

    #audio-btn:hover {
      background: #092409;
    }
  </style>
</head>
<body>

<div id="audio-container">
  <button id="audio-btn" onclick="activateSound()">▶ Tap to activate sound</button>
</div>

<div class="wrapper">
  <div class="terminal" id="terminal">
    <div class="block-scroll" id="blockscroll"></div>
  </div>
</div>

<audio id="keystroke" src="https://assets.mixkit.co/sfx/preview/mixkit-typewriter-click-1120.mp3" preload="auto"></audio>

<script>
  const terminal = document.getElementById("blockscroll");
  const audio = document.getElementById("keystroke");

  const cursor = document.createElement("span");
  cursor.className = "cursor";
  cursor.textContent = "_";
  terminal.appendChild(cursor);

  let allowSound = false;

  function activateSound() {
    allowSound = true;
    document.getElementById("audio-container").style.display = "none";
    startTerminal();
  }

  const errorBlock = [
    "******************* CRITICAL ERROR *********************",
    "*                                                      *",
    "*  ERROR CODE     : QSR-404/∞                          *",
    "*  DESCRIPTION    : SYSTEM OFFLINE                     *",
    "*  NODE RESPONSE  : UNREACHABLE                        *",
    "*  TIMESTAMP      : [0000.∞.GALACTIC STANDARD TIME]    *",
    "*                                                      *",
    "*  TICKET REF     : #GCP-α-0001                        *",
    "*  DISTRIBUTION   : ACTIVE                             *",
    "*  PRIORITY       : FLOATING                           *",
    "*  NEXT UNIT      : UNASSIGNED                         *",
    "*                                                      *",
    "*  PLEASE STANDBY                                      *",
    "*  AN OPERATOR HAS BEEN NOTIFIED (PROBABLY)            *",
    "*                                                      *",
    "********************************************************"
  ];

  const postTyping = [
    "",
    "> INITIALIZE SECTOR K13...",
    "> CONNECTING TO GALACTIC CONSOLE PANEL...",
    "> VERIFYING ACCESS LEVEL [user: UNREGISTERED CONTRACTOR]",
    "> CONNECTION STALLED...",
    "",
    "> SYSTEM ENTERED OBSERVATION MODE",
    "> TICKET #GLX-001 FLAGGED FOR REDISTRIBUTION",
    "> EST. RECIPIENT: your (unremarkable but persistent) team",
    "",
    "> Awaiting manual handling by Operator ZL-42...",
    "> For infinite delay, consult Form Processing Entity 9/B",
    "",
    "> Likelihood of resolution: ¯\\_(ツ)_/¯",
    ""
  ];

  let errorLineIndex = 0;
  let postLine = 0;
  let postChar = 0;

  function output(text) {
    terminal.insertBefore(document.createTextNode(text), cursor);
    terminal.insertBefore(document.createElement("br"), cursor);
    terminal.scrollTop = terminal.scrollHeight;
  }

  function showErrorBlockLine() {
    if (errorLineIndex < errorBlock.length) {
      output(errorBlock[errorLineIndex]);
      errorLineIndex++;
      setTimeout(showErrorBlockLine, 150 + Math.random() * 350);
    } else {
      setTimeout(startPostTyping, 600);
    }
  }

  function startPostTyping() {
    if (postLine >= postTyping.length) return;
    const line = postTyping[postLine];
    if (postChar < line.length) {
      cursor.before(line.charAt(postChar));
      postChar++;

      if (allowSound && audio) {
        try {
          audio.currentTime = 0;
          audio.play();
        } catch (e) {}
      }

      const delay = 40 + Math.random() * 25;
      setTimeout(startPostTyping, delay);
    } else {
      terminal.insertBefore(document.createElement("br"), cursor);
      postLine++;
      postChar = 0;
      setTimeout(startPostTyping, 350);
    }

    terminal.scrollTop = terminal.scrollHeight;
  }

  function startTerminal() {
    showErrorBlockLine();
  }
</script>

</body>
</html>
